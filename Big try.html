<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

     <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-database.js"></script>

    <title>Furniture and Interior Decor procurement site</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"crossorigin="anonymous"/>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="sign-in.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans+Condensed:wght@300&family=Poppins:wght@200&family=Roboto+Slab:wght@200;300;400&display=swap" rel="stylesheet">
    <link rel="icon" href="/Images/fav.ico">
  </head>
<body>

<!------------stickyNAV--------------------->


    <section class="h-screen mb-40 w-full bg-black opacity-40 ">
        <div class="lg:w-full sm:w-9/12 w-7/12 ">
        
        </div>
    </section>
    <!--Holders---->
    
    <!---ALERTS-->
    <div class="errors alert animate__animated animate__bounceInLeft text-base absolute top-5 lg:w-4/12 sm:w-8/12 w-10/12 left-0 overflow-y-hidden py-2 rounded h-10 bg-red-700 text-white w-full m-auto text-center hidden">
    </div>

    <div class="goodalert animate__animated animate__bounceInLeft absolute top-5 lg:w-4/12 sm:w-8/12 w-10/12 left-0 overflow-y-hidden h-12 py-6 bg-green-400 rounded text-white w-full m-auto text-center hidden">
      <h1 class="-mt-3 text-lg">Account Succefully Created
    </div>




    <div class="login-div shadow h-auto lg:w-3/12 md:w-6/12 sm:w-8/12 w-10/12 m-auto">


      <div class="w-10/12 m-auto">

        

        <form id="register">
           
          <div class="input-group mt-6 border border-current bg-white px-2 mt-6 rounded">
            <i class="text-red-500 fas fa-envelope"></i>
            <input class="w-full py-1 focus:outline-none text-black" type="text" name="firstName" id="firstName" placeholder="Enter first name">
          </div>


          <div class="input-group mt-6 border border-current bg-white px-2 mt-6 rounded">
            <i class="text-red-500 fas fa-envelope"></i>
            <input class="w-full py-1 focus:outline-none text-black" type="text" name="lastName" id="lastName" placeholder="Enter last name"/>
          </div>
    

          <div class="input-group mt-6 border border-current bg-white px-2 mt-6 rounded">
             <i class="text-red-500 fas fa-envelope"></i>
             <input class="w-full py-1 focus:outline-none text-black" type="text" name="email" id="email" placeholder="Enter valid email"/>
          </div>

            <div class="input-group mt-6 border border-current bg-white px-2 mt-6 rounded">
              <i class="text-red-500 fas fa-envelope"></i>
              <input class="w-full py-1 focus:outline-none text-black" type="text" name="text" id="phone" placeholder="phone number"/>
            </div>
    
            <div class="input-group mt-6 border border-current bg-white px-2 rounded">
                <i class="text-red-500 fas fa-lock"></i>
                <div class="flex justify-center items-center">
                    <input class="w-full py-1 focus:outline-none text-black" type="password" name="password" id="password" placeholder="Enter password"/><i class=" text-red-500 far fa-eye" id="togglePassword"></i>
                </div>
            </div>

            <p class="text-xs leading-none font-thin mt-1 text-red-400">*Minimum of 8 characters, must consist at least 1 uppercase letter, 1 lowercase letter and 1 number</p>
    

            <div class="">
                <input type="checkbox" id="tick"><span class="text-sm text-gray-300 ml-2">By continuing I agree to the Terms of Service and Privacy Policy.</span>
            </div>
    

            <div class="input-group full my-4">
             <input onclick="signUp()" id="signUp" class="focus:outline-none py-2 w-full text-white bg-red-700 hover:bg-red-600" type="submit" value="SIGN UP" class="submit-btn" />
             <div class="clear"></div>
            </div>

                

           </div>
          
          
        </form>
    
          <div class="">
              <h1 class="text-lg pt-4"style=" font-family:Roos St Regis Display;">~ Or log in through:</h1>
              
              <i class="spin text-2xl text-blue-800 hover:text-blue-500 pr-2 cursor-pointer fab fa-facebook"></i>
              <i class="spin text-2xl text-red-700 hover:text-red-500 pr-2 cursor-pointer fab fa-google-plus"></i>
              <i class="spin text-2xl text-black hover:text-gray-900 cursor-pointer fab fa-github"></i>
          </div>

          <h1 class="py-2 text-base text-center"style=" font-family:Roos St Regis Display;">Are you new to this space? <a class="text-red-600" href="Signup.html">Register</a> here</h1>

        </div>


    </div>





      















        
    <script>

        
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAglyyyqzM0Mji52iKwAGBrAZiAUz2QX-s",
    authDomain: "form-a2fa1.firebaseapp.com",
    projectId: "form-a2fa1",
    storageBucket: "form-a2fa1.appspot.com",
    messagingSenderId: "195902252855",
    appId: "1:195902252855:web:13a5e6a3815250d9f55cb2"
  };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();

    const userRef = firebase.database().ref("User");




    const regForm = document.querySelector('form#register');
    const errors_el = document.querySelector('.errors');

    regForm.addEventListener('submit', validateRegisterForm);

    function validateRegisterForm (e) {
    e.preventDefault();
    

    const firstName = document.querySelector('#register #firstName');
    const surname = document.querySelector('#register #lastName');
    const email = document.querySelector('#register #email');
    const password = document.querySelector('#register #password');
    const phone = document.querySelector('#register #phone');
    



    let errors = [];
    
    const email_reg = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    const pass_reg = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
    
    
    
    if (firstName.value == "") {
      errors.push({text: "firstname", el: firstName});
    }
    
    if (surname.value == "") {
      errors.push({text: "lastname", el: surname});
    }
    
    if (email.value == "") {
    errors.push({text: "email", el: email});
    } else if (!email_reg.test(email.value)) {
    errors.push({text: "email", el: email});
    }
    
    if (password.value == "") {
    errors.push({text: "password", el: password});
    } else if (!pass_reg.test(password.value)) {
    errors.push({text: "password", el: password});
    }
    
    if (errors.length > 0) {
    handle_errors(errors);
    return false;
    } 
  
      //show Alert
      document.querySelector('.goodalert').style.display = 'block';

      setTimeout(function(){
          document.querySelector('.goodalert').style.display = 'none';
      },3000);

     

    auth.createUserWithEmailAndPassword(email.value, password.value)
    const user = firebase.auth().currentUser;

user.sendEmailVerification()
    
    
    .then(function(){
     
        console.log("redirect")
       
        name = firstName.value;
        last = surname.value;
        
        // phone = phone.value
        // textail = email.value
       

        saveUser(name, last);

        window.location.href = "dashboard.html";

        localStorage.setItem('nameTest', firstName.value);
        localStorage.setItem('lastTest', surname.value);
        localStorage.setItem('mailTest', email.value);
        localStorage.setItem('pnumTest', phone.value);

        
      
        displayHomePage();
        }).catch(function(error) {
        displayError(error);

     
      });
     
      
    return true;
    

    }





     //save to firebase
        function saveUser(first, last, phone, textail) {
        const newUserRef = userRef.push();
        newUserRef.set({
            name:name,
            last:last,
            phone:phone,
            textail:email
           

        });
    }

    function handle_errors(errs) {
      let str = "Error! Please check your ";
      
      errs.map((er) => {
      er.el.classList.add('error');
      str += er.text + ", ";
      });
      
      errs[0].el.focus();
      
      let error_el = document.createElement('div');
      error_el.classList.add('error');
      error_el.innerText = str;
      
      error_el.addEventListener('click', function () {
      errors_el.removeChild(error_el);
      });
      
      errors_el.appendChild(error_el);

      //show Alert
      document.querySelector('.alert').style.display = 'block';

      //set timer to hide
      setTimeout(function(){
          document.querySelector('.alert').style.display = 'none';
      },3000);

      
    
    }
    
       


    const togglePassword = document.querySelector('#togglePassword');
    const password = document.querySelector('#password');

    togglePassword.addEventListener('click', function (e) {
        // toggle the type attribute
        const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
        password.setAttribute('type', type);
        // toggle the eye slash icon
        this.classList.toggle('fa-eye-slash');
    });


  </script>

<script>
auth.onAuthStateChanged(function(user) {
      if(user) {

        var email = user.email;
        alert("Active User " + email);
      }
        //is signed in
    
    //    else {
        
    // // alert("No active user")
    //     //no user is signed in
    //   }

    
  });


</script>
  

    <script>
        function signOut() {

          auth.signOut();
          alert("Signed out");
          window.location = "Login.html";
}
    </script>



</body>
</html>